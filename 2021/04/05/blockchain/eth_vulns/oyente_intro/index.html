<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Focusing on security of AI, and distributed AI."><title>Oyente 源码阅读笔记 | realyee's blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><script src="https://www.googletagmanager.com/gtag/js?id=G-HT3KXNPC43" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HT3KXNPC43');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + '81692a5a3ea48096c98733a7d4bfef6b';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Oyente 源码阅读笔记</h1><a id="logo" href="/blog/.">realyee's blog</a><p class="description">Security and privacy of AI, and distributed AI, Cybersecurity</p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> Home</i></a><a href="/blog/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/blog/tags/"><i class="fa fa-tag"> Tags</i></a><a href="/blog/history/"><i class="fa fa-book"> History</i></a><a href="/blog/cheatsheet/"><i class="fa fa-user"> Cheatsheet</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Oyente 源码阅读笔记</h1><div class="post-meta">2021-04-05<span> | </span><span class="category"><a href="/blog/categories/blockchain/">blockchain</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2.5k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 10</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#oyente-%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">Oyente 源码阅读笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E8%87%B4%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">大致文件结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#level-one"><span class="toc-number">1.1.1.</span> <span class="toc-text">Level One</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#level-two"><span class="toc-number">1.1.2.</span> <span class="toc-text">Level Two</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#oyente.oyentemain"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">oyente.oyente:main</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#oyente.oyentehas_dependencies_installed"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">oyente.oyente:has_dependencies_installed</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#oyente.oyenteanalyze_bytecode"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">oyente.oyente:analyze_bytecode</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%89%8D%E5%8F%91%E7%8E%B0%E7%9A%84%E7%BC%BA%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">目前发现的缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.3.</span> <span class="toc-text">参考资料</span></a></li></ol></li></ol></div></div><div class="post-content"><h1 id="oyente-源码阅读笔记">Oyente 源码阅读笔记</h1>
<h2 id="大致文件结构">大致文件结构</h2>
<p>首先，通过 <code>tree -L 2</code> 查看大致 2 层文件结构：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── code.md</span><br><span class="line">├── CONTRIBUTING.md</span><br><span class="line">├── Dockerfile</span><br><span class="line">├── LICENSE</span><br><span class="line">├── misc_utils</span><br><span class="line">│   ├── generate-graphs.py</span><br><span class="line">│   ├── get_source.py</span><br><span class="line">│   ├── stats-collect.py</span><br><span class="line">│   ├── transaction_scrape 2.py</span><br><span class="line">│   ├── transaction_scrape.py</span><br><span class="line">│   └── tx-stats.py</span><br><span class="line">├── oyente</span><br><span class="line">│   ├── analysis.py</span><br><span class="line">│   ├── ast_helper.py</span><br><span class="line">│   ├── ast_walker.py</span><br><span class="line">│   ├── basicblock.py</span><br><span class="line">│   ├── batch_run.py</span><br><span class="line">│   ├── ethereum_data1.py</span><br><span class="line">│   ├── ethereum_data.py</span><br><span class="line">│   ├── global_params.py</span><br><span class="line">│   ├── __init__.py</span><br><span class="line">│   ├── input_helper.py</span><br><span class="line">│   ├── opcodes.py</span><br><span class="line">│   ├── oyente.py</span><br><span class="line">│   ├── run_tests.py</span><br><span class="line">│   ├── source_map.py</span><br><span class="line">│   ├── state.json</span><br><span class="line">│   ├── symExec.py</span><br><span class="line">│   ├── test_evm</span><br><span class="line">│   ├── utils.py</span><br><span class="line">│   ├── vargenerator.py</span><br><span class="line">│   └── vulnerability.py</span><br><span class="line">├── pylintrc</span><br><span class="line">├── README.md</span><br><span class="line">├── setup.py</span><br><span class="line">├── sol_examples</span><br><span class="line">│   ├── BECToken.sol</span><br><span class="line">│   ├── calls.sol</span><br><span class="line">│   ├── etherstore.sol</span><br><span class="line">│   ├── exceptions.sol</span><br><span class="line">│   ├── hashforether.sol</span><br><span class="line">│   ├── origin.sol</span><br><span class="line">│   ├── returnvalue.sol</span><br><span class="line">│   ├── rubixi.sol</span><br><span class="line">│   ├── suicide.sol</span><br><span class="line">│   ├── timelock.sol</span><br><span class="line">│   ├── token.sol</span><br><span class="line">│   ├── WalletLibrary.sol</span><br><span class="line">│   └── weak_random.sol</span><br><span class="line">└── web</span><br><span class="line">    ├── app</span><br><span class="line">    ├── bin</span><br><span class="line">    ├── browser-solidity</span><br><span class="line">    ├── config</span><br><span class="line">    ├── config.ru</span><br><span class="line">    ├── db</span><br><span class="line">    ├── Gemfile</span><br><span class="line">    ├── Gemfile.lock</span><br><span class="line">    ├── lib</span><br><span class="line">    ├── log</span><br><span class="line">    ├── package.json</span><br><span class="line">    ├── public</span><br><span class="line">    ├── Rakefile</span><br><span class="line">    ├── README.md</span><br><span class="line">    ├── test</span><br><span class="line">    ├── vendor</span><br><span class="line">    └── yarn.lock</span><br><span class="line"></span><br><span class="line">15 directories, 52 files</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="level-one">Level One</h3>
<p>几个关键些的文件（夹）：</p>
<p><code>README.md</code> ：我们在 Github 下载的时候已经看了，讲解
docker 或者依赖安装等 <code>code.md</code>
：中讲述了本项目的大致代码结构，可以先看一遍，然后看代码的时候对照着看。
<code>setup.py</code> : setuptools 的构建脚本，用来告诉 setuptools
关于本项目（包）的描述、入口点、数据、包含的模块等，可以看一遍了解项目概况。关于
<code>setup.py</code> 的详细信息，见 Packaging Python Projects <a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> <code>misc_utils 文件夹</code> :
杂项，放了一些对本项目实用的工具脚本 <code>oyente 文件夹</code> ：
项目的主要源码文件夹</p>
<p><code>sol_examples 文件夹</code> : 是我在 <a
target="_blank" rel="noopener" href="https://github.com/ConsenSys/mythril/tree/develop/solidity_examples">Mythril
的 github 仓库</a> 下载的，便于测试使用（如果可以的话）。</p>
<h3 id="level-two">Level Two</h3>
<h4 id="oyente.oyentemain">oyente.oyente:main</h4>
<p>入口点： oyente 文件夹中 <code>oyente.py</code> 的 main() 函数</p>
<ol start="0" type="1">
<li><p>声明 args 全局变量</p>
<p>后面在 analyze_bytecode 等函数中会用到输入参数们 args。</p>
<p>这里编码不规范，应该在所有函数外声明全局变量，虽然可以在函数内创建全局变量，但是不推荐，<a
href="#fn2" class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a></p></li>
<li><p>通过 argparse 模块设置参数</p>
<ul>
<li>只需要 True 或者 False 的选项，使用了 argparse 的 action 参数<a
href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a></li>
</ul>
<p>比如：args.source、args.evm、args.standard_json
等输入输出类型、过程配置相关参数</p>
<ul>
<li><p>dest 参数明确指定参数属性名<a href="#fn4" class="footnote-ref"
id="fnref4" role="doc-noteref"><sup>4</sup></a></p></li>
<li><p>nargs 对一个 action 绑定多个参数，其值为 “+” 时，把该 action
所有参数 gathered into a list <a href="#fn5" class="footnote-ref"
id="fnref5" role="doc-noteref"><sup>5</sup></a></p></li>
</ul>
<ol type="1">
<li><p>输入</p>
<p>接受三种输入：solidity program、evm bytecode、remote contracts
这里，它使用 <code>add_mutually_exclusive_group(require=True)</code>
互斥参数组来确保将互斥组中只有一个参数在命令行中可用，且至少有一个。
具体输入类型: | 类型| 本地 | 远程 URL| |-------|----|-------| | solidity
| -s filename | -ru url_address| | 字节码 | -b -s filename | -b -ru
url_address|</p>
<p>solidity 源码，还可以指定输入为标准 json 格式。</p></li>
<li><p>程序运行配置相关</p>
<p>如：指定运行 <strong>solidity 源码</strong>中的某（几）个合约
target-contract、并行 parallel、debug 等</p></li>
<li><p>运行过程中相关 IO 处理、操作相关</p>
<p>如，输出报错，创建报告等</p></li>
<li><p>检测运行相关</p>
<p>如：Gas、loop、depth 的限制、路径等</p></li>
</ol></li>
<li><p>根据输入的参数和预先设置 0. 如果为本地文件（.sol 或 .evm），通过
-s 选项，获取到 args.source 的值</p>
<ol type="1">
<li>进行全局参数、日志配置</li>
<li>确保指定检测某个合约的功能，只能在源码输入情况下进行。</li>
<li><code>has_dependencies_installed</code> 判断依赖（
<code>z3、evm、solc</code> ）是否安装，并通过
<code>compare_versions</code>
函数比较版本是否为测试版本(及以下)，如不满足，则提示、并退出程序。</li>
<li>如果是远程 URL，则创建 remote_contract.sol 或
remote_contract.evm，并使用 requests 模块写入,然后设置 args.source
为文件名</li>
<li>检测字节码 <code>analyze_solidity</code> 或者源码
<code>analyze_solidity</code></li>
<li>检测完毕，退出 <code>exit_code</code></li>
</ol></li>
</ol>
<h4
id="oyente.oyentehas_dependencies_installed">oyente.oyente:has_dependencies_installed</h4>
<p>本函数判断依赖是否安装、且版本是否为测试版本(及以下), 版本要求：
<code>z3 &lt;= 4.5.1</code> 、 <code>evm &lt;= 1.7.3</code> 、
<code>solc &lt;= 0.4.19</code> ，否则退出程序</p>
<p>几个注意的点：</p>
<ol type="1">
<li><p>Python 运行终端命令， <code>type cmd</code> 判断命令是否存在</p>
<ol type="1">
<li>cmd_exist 开启一个子进程在 shell 中执行 <code>type cmd</code>
命令来判断是否存在</li>
</ol>
<p>为什么要使用子进程测试呢？ 属于 ”Python 中调用 Linux
命令并获取返回值“ 知识范畴<a href="#fn6" class="footnote-ref"
id="fnref6" role="doc-noteref"><sup>6</sup></a> 结论：如果要兼容 python
3.5 以下就用 subprocess.call，反之，用 subprocess.run<a href="#fn7"
class="footnote-ref" id="fnref7"
role="doc-noteref"><sup>7</sup></a></p></li>
<li><p>获得版本</p></li>
<li><p>比较版本 <a href="#fn8" class="footnote-ref" id="fnref8"
role="doc-noteref"><sup>8</sup></a></p>
<p>通过 <code>compare_versions</code> 函数，使用 pypthon2 的 cmp
比较，但是还通过 six 模块判断，在比较时，对 python3 做了兼容，</p>
<ul class="task-list">
<li><label><input
type="checkbox" />这里的比较函数需要区分小于等于和大于，可以直接改用
<code>&lt;=</code> ,然后把调用该函数那儿的判断改一下。</label></li>
</ul>
<p>python 中直接使用 <code>&lt;、&gt;、==、&gt;=</code>
等进行比较即可</p>
<p>为什么要比较小于等于？ 版本的向后兼容性(Backward Compatibility)<a
href="#fn9" class="footnote-ref" id="fnref9"
role="doc-noteref"><sup>9</sup></a></p>
<p>不过，有的 urllib2 等又没有对 python2 做兼容，真是奇怪。我们直接上
python3，不用兼容 python2，它都要被淘汰了。</p></li>
<li><p>判断 z3 依赖的方法</p>
<p>它采用捕获 import 异常的方法以及获取版本函数的方式</p>
<p>在我的 linux 上，z3 也可以通过 <code>type z3</code>
判断存在与否，通过 <code>z3 --version</code>
来获取版本，即：和其他两个依赖方法一直。 但是我的 Ubuntu server
上貌似不行，后面看看你们可不可以，如果可以，那这里用函数把三者统一一下。</p>
<ul class="task-list">
<li><label><input
type="checkbox" />这里可以优化一下，把三个依赖是否存在的判断方法写成一个函数。</label></li>
</ul></li>
</ol>
<p>判断命令是否存在，一般有 type、hash、python 捕获导入异常<a
href="#fn10" class="footnote-ref" id="fnref10"
role="doc-noteref"><sup>10</sup></a> <a href="#fn11"
class="footnote-ref" id="fnref11"
role="doc-noteref"><sup>11</sup></a></p>
<h4
id="oyente.oyenteanalyze_bytecode">oyente.oyente:analyze_bytecode</h4>
<ol type="1">
<li><p>创建 Input_Helper 类的对象</p>
<p>类对象的初始化操作主要工作 确定要检测的文件类型与位置
设置默认参数，并获取一些配置参数</p>
<ol type="1">
<li><p>并根据输入类型：字节码设置一些默认属性</p>
<p>传入 InputHelper.BYTECODE
共有类属性[^class_attr]，来说明输入为字节码</p></li>
<li><p>遍历字典项：属性</p>
<p>使用 six.iteritems 遍历字典，做了 python2/3 的兼容<a href="#fn12"
class="footnote-ref" id="fnref12"
role="doc-noteref"><sup>12</sup></a>，这里再说一句，本项目没有全部兼容处理，有问题。。
通过字典的 指定 default 参数的 get 方法获取属性<a href="#fn13"
class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>
使用 setattr 实现在循环中，设置任意属性名和任意属性值<a href="#fn14"
class="footnote-ref" id="fnref14"
role="doc-noteref"><sup>14</sup></a></p></li>
</ol></li>
<li><p>调用 helper 对象的 get_inputs()
获取返回列表的第一项，其内容为：反汇编结果的文件名</p>
<ol type="1">
<li><p>对于指定检测 solidity 源码文件中的某几个合约的，get_inputs
采用了默认参数</p>
<p>了解一下，可变参数（这里的话，就是 list）的默认参数需要设置为 None <a
href="#fn15" class="footnote-ref" id="fnref15"
role="doc-noteref"><sup>15</sup></a></p></li>
<li><p>对于字节码，它根据 args.source 中的文件名读取内容到 bytecode
变量</p></li>
<li><p>将 bytecode 传递给自身的私有方法
<code>_prepare_disasm_file</code></p></li>
<li><p>_prepare_disasm_file 处理字节码，并生成反汇编文件</p>
<ol type="1">
<li><p>通过 _write_evm_file 进行去 SwarmHash 处理<a href="#fn16"
class="footnote-ref" id="fnref16"
role="doc-noteref"><sup>16</sup></a>,然后写入到
<code>f"&#123;args.source&#125;.evm"</code> 文件中</p>
<p>去除它的原因：swarm hash in bytecode can be misinterpreted as INVALID
opcode</p>
<p>SwarmHash/Swarm 是一个点对点文件共享系统，设计用来有效地存储和检索
ethereum 应用程序和合约中所需的数据。 最简单的类比应该是：Swarm 本质上是
ether 的 BitTorrent。 solc 编译后的字节码里面有个 CBOR
元数据编码，它里面就有 SwarmHash。SwarmHash
以固定的串开头，以固定的串结尾。</p>
<ul class="task-list">
<li><label><input type="checkbox" />不同版本（们？）之间的 SwarmHash
的开头和结尾的固定部分好像有所变化，需要仔细调研一下。</label></li>
</ul></li>
<li><p>通过 _write_disasm_file 读取上一步处理好的 <code>.evm</code>
，然后反汇编，并写入到 <code>f"&#123;args.source&#125;.evm.disasm"</code>
文件中</p>
<ol type="1">
<li><p>读取上一步处理完的字节码到 <code>evm_file</code> 变量</p></li>
<li><p>开启一个子进程 subprocess，通过执行终端命令：
<code>evm disasm evm_file</code> ，若反汇编失败则退出程序</p>
<p>这里使用了 popen<a href="#fn17" class="footnote-ref" id="fnref17"
role="doc-noteref"><sup>17</sup></a> run 函数的底层，就是 Popen
函数。run 函数是同步的，要等待子进程实行结束，或者超时。Popen
创建子进程后，采用异步的方式，不会等待。Popen 比 run 要更加灵活，如果
run 函数还不能满足你的需求，就考虑 Popen</p>
<ul class="task-list">
<li><label><input type="checkbox" />run 和 popen 选择？</label></li>
</ul></li>
<li><p>将反汇编结果写入
<code>f"&#123;args.source&#125;.evm.disasm"</code></p></li>
</ol></li>
</ol></li>
<li><p>然后将反汇编结果文件名作
<code>&#123;'disasm_file': disasm_file&#125;</code> 字典，附加到 inputs
列表中并返回</p>
<ul class="task-list">
<li><label><input
type="checkbox" />不知道这里要用列表，不就是一个字典元素</label></li>
</ul></li>
</ol></li>
<li><p>将反汇编的文件名传入 symExec.run()
开始符号执行，检测漏洞，并返回结果和退出码</p></li>
<li><p>删除临时文件</p>
<p>包括之前生成的“处理过的字节码文件”，“反汇编结果文件”，还有日志等。</p></li>
<li><p>如果是全局参数 WEB 设置了，使用 six.print_ 输出一下 json
格式的结果。</p></li>
<li><p>返回退出码</p></li>
</ol>
<h2 id="目前发现的缺点">目前发现的缺点</h2>
<ol type="1">
<li><p>在函数内使用 global <strong>创建</strong>全局变量
苏安然可以这样用，但是貌似不推荐？</p></li>
<li><p>python2 与 python3 兼容性没做好 虽然使用了 six
模块，但是只用其处理了 print，没处理好比较、urllib2 等，还是不能兼容
python2 和 python3</p></li>
<li><p>模块化不彻底，不同功能之间有点混乱。
感觉相互之间交叉，功能有点混乱，也可能是我看源码的能力不够？</p></li>
<li><p>动态为对象添加属性 不太方便看，不知道规不规范?</p></li>
<li><p>获取判断依赖那里没准可以统一用函数？</p></li>
</ol>
<h2 id="参考资料">参考资料</h2>
<ol start="0" type="1">
<li><a
target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/22494/copy-file-to-xclip-and-paste-to-firefox">Copy
file to xclip and paste to Firefox</a></li>
</ol>
<p>[^class_attr]：<a
target="_blank" rel="noopener" href="https://www.python-course.eu/python3_class_and_instance_attributes.php#:~:text=Class%20attributes%20are%20attributes%20which,%20right%20below%20the%20class%20header.">Class
and Instance Attributes</a> <a
target="_blank" rel="noopener" href="https://blog.csdn.net/qq_31780525/article/details/72639491">Python
中的类属性、实例属性与类方法、静态方法</a></p>
<aside id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><a
target="_blank" rel="noopener" href="https://packaging.python.org/tutorials/packaging-projects/">Packaging
Python Projects</a><a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/4693120/use-of-global-keyword-in-python">Use
of “global” keyword in Python</a> <a
target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/global-keyword-in-python/">Global
keyword in Python</a><a href="#fnref2" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a
target="_blank" rel="noopener" href="https://docs.python.org/3/library/argparse.html#action">py3_doc_argpasre_action</a><a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a
target="_blank" rel="noopener" href="https://docs.python.org/3/library/argparse.html#dest">py3_doc_argpasre_dest</a><a
href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a
target="_blank" rel="noopener" href="https://docs.python.org/3/library/argparse.html#nargs">py3_doc_argpasre_nargs</a><a
href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><a
target="_blank" rel="noopener" href="https://www.cnblogs.com/mianbaoshu/p/12024498.html">Python 中调用
Linux 命令并获取返回值</a> <a
target="_blank" rel="noopener" href="https://docs.python.org/3/library/os.html#os.system">os.system(command)</a>
<a
target="_blank" rel="noopener" href="https://docs.python.org/3/library/subprocess.html#subprocess.run">Using
the subprocess Module</a> <a
target="_blank" rel="noopener" href="https://docs.python.org/3/library/subprocess.html#module-subprocess">Older
high-level API</a> <a
target="_blank" rel="noopener" href="https://blog.csdn.net/bcfdsagbfcisbg/article/details/78180650">关于
os.system 和 os.popen 的坑</a><a href="#fnref6" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><a target="_blank" rel="noopener" href="https://www.pynote.net/archives/490">subprocess
模块教程</a><a href="#fnref7" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><a
target="_blank" rel="noopener" href="https://codegolf.stackexchange.com/questions/49778/how-can-i-use-cmpa-b-with-python3">How
can I use cmp(a, b) with Python3?</a> <a
target="_blank" rel="noopener" href="https://portingguide.readthedocs.io/en/latest/comparisons.html">Comparing
and Sorting</a><a href="#fnref8" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/28195702">向前兼容与向后兼容</a><a
href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/592620/how-can-i-check-if-a-program-exists-from-a-bash-script">How
can I check if a program exists from a Bash script?</a> <a
target="_blank" rel="noopener" href="https://www.jianshu.com/p/fbffa5cc49e1">Bash
中如何判断一个命令是否存在</a><a href="#fnref10" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/longerzone/article/details/12948925">Linux
下的两个特殊的文件 -- /dev/null 和 /dev/zero 简介及对比</a> <a
target="_blank" rel="noopener" href="https://blog.csdn.net/sunboy_2050/article/details/9288353">Linux
Shell 1&gt;/dev/null 2&gt;&amp;1 含义</a> <a
target="_blank" rel="noopener" href="https://www.zhihu.com/question/53295083">shell 程序中 2&gt;
/dev/null 代表什么意思？</a><a href="#fnref11" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><a
target="_blank" rel="noopener" href="https://six.readthedocs.io/#six.iteritems">six_iteritems</a><a
href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p><a
target="_blank" rel="noopener" href="https://www.runoob.com/python/att-dictionary-get.html">Python
字典(Dictionary) get()方法</a> <a
target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-setattr.html">Python
setattr() 函数</a> <a
target="_blank" rel="noopener" href="https://blog.csdn.net/Ghost_leader/article/details/60145971?utm_source=blogxgwz4">python
中的 setattr 的使用</a> <a
target="_blank" rel="noopener" href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c07/p05_define_functions_with_default_arguments.html">定义有默认参数的函数</a><a
href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p><a
target="_blank" rel="noopener" href="https://www.runoob.com/python/att-dictionary-get.html">Python
字典(Dictionary) get()方法</a> <a
target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-setattr.html">Python
setattr() 函数</a> <a
target="_blank" rel="noopener" href="https://blog.csdn.net/Ghost_leader/article/details/60145971?utm_source=blogxgwz4">python
中的 setattr 的使用</a> <a
target="_blank" rel="noopener" href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c07/p05_define_functions_with_default_arguments.html">定义有默认参数的函数</a><a
href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p><a
target="_blank" rel="noopener" href="https://www.runoob.com/python/att-dictionary-get.html">Python
字典(Dictionary) get()方法</a> <a
target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-setattr.html">Python
setattr() 函数</a> <a
target="_blank" rel="noopener" href="https://blog.csdn.net/Ghost_leader/article/details/60145971?utm_source=blogxgwz4">python
中的 setattr 的使用</a> <a
target="_blank" rel="noopener" href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c07/p05_define_functions_with_default_arguments.html">定义有默认参数的函数</a><a
href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p><a
target="_blank" rel="noopener" href="https://www.one-tab.com/page/XHxD-FQcRxiUoyGZGQ8Gjw">OneTab
Shared: 9 tabs</a><a href="#fnref16" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p><a
target="_blank" rel="noopener" href="https://www.pynote.net/archives/490">subprocess 模块教程</a><a
href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/blog/2021/04/10/blockchain/eth_vulns/paper_osiris/">Osiris 论文阅读笔记</a><a class="next" href="/blog/2021/03/30/blockchain/0.intro/">区块链入门介绍:从历史到原理</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/" title=""><img class="nofancybox" src="/blog/img/avatar.png"/></a><p>What keeps me alive is my love for people and life and my desire to explore the unknown</p><a class="info-icon" href="mailto:findrealyee@outlook.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/realyee/" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Cryptography/">Cryptography</a><span class="category-list-count">29</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Cryptography/math/">math</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Cryptography/zero-knowledge-proof/">zero-knowledge proof</a><span class="category-list-count">20</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Golang/">Golang</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/academic/">academic</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/blockchain/">blockchain</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/cplusplus/">cplusplus</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/go/">go</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/">linux</a><span class="category-list-count">34</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/git/">git</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/macos/">macos</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/tools/">tools</a><span class="category-list-count">12</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/misc/">misc</a><span class="category-list-count">16</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/misc/latex/">latex</a><span class="category-list-count">5</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/ml/">ml</a><span class="category-list-count">27</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/ml/rl/">rl</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/network/">network</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/os/">os</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/php/">php</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/probabilities/">probabilities</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/python/">python</a><span class="category-list-count">64</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/security-miscellaneous/">security miscellaneous</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/shell/">shell</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/utilities/">utilities</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/">websec</a><span class="category-list-count">35</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/cmd-execution/">cmd_execution</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/file-upload/">file_upload</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/logic-vuln/">logic_vuln</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/sql-injection/">sql injection</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/xss/">xss</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/wireshark/">wireshark</a><span class="category-list-count">7</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/blog/tags/academic/" style="font-size: 15px;">academic</a> <a href="/blog/tags/sci/" style="font-size: 15px;">sci</a> <a href="/blog/tags/jcr/" style="font-size: 15px;">jcr</a> <a href="/blog/tags/ml/" style="font-size: 15px;">ml</a> <a href="/blog/tags/cuda/" style="font-size: 15px;">cuda</a> <a href="/blog/tags/misc/" style="font-size: 15px;">misc</a> <a href="/blog/tags/vscode/" style="font-size: 15px;">vscode</a> <a href="/blog/tags/threat-intelligence/" style="font-size: 15px;">threat intelligence</a> <a href="/blog/tags/typing/" style="font-size: 15px;">typing</a> <a href="/blog/tags/distance/" style="font-size: 15px;">distance</a> <a href="/blog/tags/osi-sec/" style="font-size: 15px;">osi_sec</a> <a href="/blog/tags/smtp/" style="font-size: 15px;">smtp</a> <a href="/blog/tags/mail/" style="font-size: 15px;">mail</a> <a href="/blog/tags/Boot/" style="font-size: 15px;">Boot</a> <a href="/blog/tags/Computer/" style="font-size: 15px;">Computer</a> <a href="/blog/tags/FAT/" style="font-size: 15px;">FAT</a> <a href="/blog/tags/FDT/" style="font-size: 15px;">FDT</a> <a href="/blog/tags/os/" style="font-size: 15px;">os</a> <a href="/blog/tags/efi/" style="font-size: 15px;">efi</a> <a href="/blog/tags/Python/" style="font-size: 15px;">Python</a> <a href="/blog/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/blog/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" style="font-size: 15px;">网络协议</a> <a href="/blog/tags/Wireshark%E5%8A%9F%E8%83%BD/" style="font-size: 15px;">Wireshark功能</a> <a href="/blog/tags/%E6%B8%97%E9%80%8F/" style="font-size: 15px;">渗透</a> <a href="/blog/tags/%E6%8A%93%E5%8C%85/" style="font-size: 15px;">抓包</a> <a href="/blog/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">计算机网络</a> <a href="/blog/tags/zkp/" style="font-size: 15px;">zkp</a> <a href="/blog/tags/circom/" style="font-size: 15px;">circom</a> <a href="/blog/tags/git/" style="font-size: 15px;">git</a> <a href="/blog/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/blog/tags/arch/" style="font-size: 15px;">arch</a> <a href="/blog/tags/manjaro/" style="font-size: 15px;">manjaro</a> <a href="/blog/tags/chmod/" style="font-size: 15px;">chmod</a> <a href="/blog/tags/ping/" style="font-size: 15px;">ping</a> <a href="/blog/tags/network/" style="font-size: 15px;">network</a> <a href="/blog/tags/find/" style="font-size: 15px;">find</a> <a href="/blog/tags/head/" style="font-size: 15px;">head</a> <a href="/blog/tags/tail/" style="font-size: 15px;">tail</a> <a href="/blog/tags/ioredirect/" style="font-size: 15px;">ioredirect</a> <a href="/blog/tags/pipe/" style="font-size: 15px;">pipe</a> <a href="/blog/tags/fd/" style="font-size: 15px;">fd</a> <a href="/blog/tags/iproute2/" style="font-size: 15px;">iproute2</a> <a href="/blog/tags/kill/" style="font-size: 15px;">kill</a> <a href="/blog/tags/hardlink/" style="font-size: 15px;">hardlink</a> <a href="/blog/tags/softlink/" style="font-size: 15px;">softlink</a> <a href="/blog/tags/netstat/" style="font-size: 15px;">netstat</a> <a href="/blog/tags/ss/" style="font-size: 15px;">ss</a> <a href="/blog/tags/lsof/" style="font-size: 15px;">lsof</a> <a href="/blog/tags/traceroute/" style="font-size: 15px;">traceroute</a> <a href="/blog/tags/vim/" style="font-size: 15px;">vim</a> <a href="/blog/tags/latex/" style="font-size: 15px;">latex</a> <a href="/blog/tags/CNN/" style="font-size: 15px;">CNN</a> <a href="/blog/tags/convolution/" style="font-size: 15px;">convolution</a> <a href="/blog/tags/CMake/" style="font-size: 15px;">CMake</a> <a href="/blog/tags/Make/" style="font-size: 15px;">Make</a> <a href="/blog/tags/php/" style="font-size: 15px;">php</a> <a href="/blog/tags/python/" style="font-size: 15px;">python</a> <a href="/blog/tags/re/" style="font-size: 15px;">re</a> <a href="/blog/tags/Regexp/" style="font-size: 15px;">Regexp</a> <a href="/blog/tags/shell/" style="font-size: 15px;">shell</a> <a href="/blog/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/blog/tags/pseudo-static/" style="font-size: 15px;">pseudo static</a> <a href="/blog/tags/sql-injection/" style="font-size: 15px;">sql injection</a> <a href="/blog/tags/XSS/" style="font-size: 15px;">XSS</a> <a href="/blog/tags/collection/" style="font-size: 15px;">collection</a> <a href="/blog/tags/collections/" style="font-size: 15px;">collections</a> <a href="/blog/tags/comprehensions/" style="font-size: 15px;">comprehensions</a> <a href="/blog/tags/fun/" style="font-size: 15px;">fun</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2023/09/18/ml/wasserstein_dist/">Delve into Wasserstein Distance, principles and implementation analysis</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/09/17/math/probabilities/wasserstein_bg/">Probabilities background for Wasserstein Distance</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/11/academic/papers/ldp_location/">L-SRR Local Differential Privacy for Location-Based Services with Staircase Randomized Response</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/10/academic/papers/ldp_byz_fl/">Practical Differentially Private and Byzantine-resilient Federated Learning</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/04/academic/papers/fedrecover/">FedRecover 论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/04/academic/papers/flcert/">FLCert Provably Secure Federated Learning against Poisoning Attacks 论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/04/academic/papers/fltrust/">FLTrust Byzantine-robust Federated Learning via Trust Bootstrapping 论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/05/30/crypto/zk/specific2program/">zk with programmability</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/04/30/crypto/zk/great_resource/">zk 资料汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/04/16/misc/latex/latex_grammars/">常用 LaTeX 语法总结</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://snowolf0620.xyz/" title="snowolf0620" target="_blank">snowolf0620</a><ul></ul><a href="https://space.keter.top/" title="Sonder" target="_blank">Sonder</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/blog/." rel="nofollow">realyee's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/blog/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/blog/css/search.css?v=1.0.0"><script type="text/javascript" src="/blog/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/blog/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/blog/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=1.0.0"></script></div></body></html>